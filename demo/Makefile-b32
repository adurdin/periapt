###############################################################################
##    Makefile-b32
##
##    This file is part of Object Script Module
##    Copyright (C) 2004 Tom N Harris <telliamed@whoopdedo.cjb.net>
##
##    Permission is hereby granted, free of charge, to any person obtaining
##    a copy of this software and associated documentation files (the 
##    "Software"), to deal in the Software without restriction, including 
##    without limitation the rights to use, copy, modify, merge, publish, 
##    distribute, sublicense, and/or sell copies of the Software, and to 
##    permit persons to whom the Software is furnished to do so.
##    
##    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, 
##    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES 
##    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-
##    INFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS 
##    BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN 
##    AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR 
##    IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN 
##    THE SOFTWARE.
##
###############################################################################

.autodepend
.cacheautodepend

.suffixes:
.suffixes: .o .cpp .rc .res

BCCROOT = D:\BCC

IMPLIB = $(BCCROOT)\bin\Implib
ILINK32 = $(BCCROOT)\bin\ILink32
TLIB = $(BCCROOT)\bin\TLib
BRC32 = $(BCCROOT)\bin\Brc32
TASM32 = $(BCCROOT)\bin\Tasm32
CC = $(BCCROOT)\bin\BCC32

srcdir = .

GAME = 2

LGDIR = ..

DEFINES = -DWINVER=0x0500 -D_WIN32_WINNT=0x0500 -DWIN32_LEAN_AND_MEAN -D_DARKGAME=$(GAME)

!ifdef DEBUG
DEFINES = $(DEFINES) -D_DEBUG 
CXXDEBUG = -v -y -O0 
LDDEBUG = -v
LGLIB = lg-d.lib
!else
DEFINES = $(DEFINES) -DNDEBUG
CXXDEBUG = -O2 -5 -OS -v-
LDDEBUG = -v-
LGLIB = lg.lib
!endif

LDFLAGS = -aa -Tpd -c -b:0x10000000
LIBDIRS = -L.;$(LGDIR);$(BCCROOT)\lib;$(BCCROOT)\lib\psdk
LIBS = $(LGLIB) uuid.lib
INCLUDES = -I. -I$(srcdir) -I$(LGDIR)
CXXFLAGS =  -q -P -VM -VF -tWD -w-par
RCFLAGS = -r

BCC32STARTUP = c0d32.obj
BCC32RTLIB = cw32.lib
BCCJUNK = *.il* *.csm *.tds *.map

.cpp.obj:
	$(CC) $(CXXFLAGS) $(CXXDEBUG) $(DEFINES) $(INCLUDES) -c $<

.obj.osm:
	$(ILINK32) $(LDFLAGS) $(LIBDIRS) $(BCC32STARTUP) ScriptModule.obj Script.obj $<, $@ ,,import32.lib $(LIBS) $(BCC32RTLIB) , script-b32.def ,

all:

clean:
	del /q *.obj *.osm $(BCCJUNK)

empty.osm: ScriptModule.obj Script.obj

Demo.osm: ScriptModule.obj Script.obj
